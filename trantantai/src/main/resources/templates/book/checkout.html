<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh Toán - BookHaven</title>
    <th:block th:replace="~{layout::link-css}"></th:block>
    <th:block th:replace="~{layout::custom-css}"></th:block>
    <style>
        /* ═══════════════════════════════════════════════════════════════════════════
           CHECKOUT PAGE - Premium Payment Experience
           ═══════════════════════════════════════════════════════════════════════════ */

        .checkout-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-xl) var(--space-lg);
        }

        .checkout-header {
            text-align: center;
            margin-bottom: var(--space-3xl);
            position: relative;
        }

        .checkout-header::after {
            content: '';
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--gradient-teal);
            border-radius: var(--radius-full);
        }

        .checkout-title {
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--ink);
            margin: 0 0 var(--space-sm) 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-md);
        }

        .checkout-title svg {
            color: var(--teal);
        }

        .checkout-subtitle {
            font-family: var(--font-body);
            font-size: 1.1rem;
            color: var(--slate);
            margin: 0;
        }

        /* Progress Steps */
        .checkout-steps {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            margin-bottom: var(--space-3xl);
            position: relative;
        }

        .checkout-steps::before {
            content: '';
            position: absolute;
            top: 24px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 2px;
            background: var(--mist);
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-sm);
            position: relative;
            z-index: 1;
        }

        .step-number {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 700;
            background: var(--white);
            border: 3px solid var(--mist);
            color: var(--slate);
            transition: all var(--transition-base);
        }

        .step.active .step-number {
            background: var(--gradient-teal);
            border-color: var(--teal);
            color: var(--white);
            box-shadow: 0 4px 20px rgba(13, 148, 136, 0.3);
        }

        .step.completed .step-number {
            background: var(--success);
            border-color: var(--success);
            color: var(--white);
        }

        .step-label {
            font-family: var(--font-body);
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--slate);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .step.active .step-label {
            color: var(--teal);
        }

        /* Main Layout */
        .checkout-grid {
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: var(--space-2xl);
            align-items: start;
        }

        /* Payment Methods Section */
        .payment-section {
            background: var(--white);
            border-radius: var(--radius-2xl);
            padding: var(--space-2xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--mist);
        }

        .section-title-checkout {
            font-family: var(--font-display);
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--ink);
            margin: 0 0 var(--space-xl) 0;
            padding-bottom: var(--space-md);
            border-bottom: 2px solid var(--mist);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .section-title-checkout svg {
            color: var(--teal);
        }

        /* Payment Method Cards */
        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .payment-method {
            position: relative;
            background: var(--cloud);
            border: 2px solid var(--mist);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            cursor: pointer;
            transition: all var(--transition-base);
            overflow: hidden;
        }

        .payment-method::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: transparent;
            transition: background var(--transition-base);
        }

        .payment-method:hover {
            border-color: var(--teal-light);
            background: var(--white);
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .payment-method.selected {
            border-color: var(--teal);
            background: linear-gradient(135deg, #f0fdfa 0%, var(--white) 100%);
            box-shadow: 0 8px 30px rgba(13, 148, 136, 0.15);
        }

        .payment-method.selected::before {
            background: var(--gradient-teal);
        }

        .payment-method-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .payment-radio {
            position: relative;
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .payment-radio input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 1;
        }

        .payment-radio-custom {
            position: absolute;
            inset: 0;
            border: 2px solid var(--stone);
            border-radius: 50%;
            background: var(--white);
            transition: all var(--transition-base);
        }

        .payment-radio-custom::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 12px;
            height: 12px;
            background: var(--gradient-teal);
            border-radius: 50%;
            transition: transform var(--transition-base);
        }

        .payment-method.selected .payment-radio-custom {
            border-color: var(--teal);
        }

        .payment-method.selected .payment-radio-custom::after {
            transform: translate(-50%, -50%) scale(1);
        }

        .payment-icon {
            width: 64px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            overflow: hidden;
            flex-shrink: 0;
        }

        /* COD Icon Style */
        .payment-icon-cod {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
        }

        .payment-icon-cod svg {
            color: #d97706;
        }

        /* MOMO Icon Style */
        .payment-icon-momo {
            background: linear-gradient(135deg, #fce7f3 0%, #f9a8d4 100%);
            border: 2px solid #ec4899;
        }

        .payment-icon-momo svg {
            color: #be185d;
        }

        .payment-info {
            flex: 1;
        }

        .payment-name {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--ink);
            margin: 0 0 var(--space-xs) 0;
        }

        .payment-desc {
            font-family: var(--font-body);
            font-size: 0.9rem;
            color: var(--slate);
            margin: 0;
            line-height: 1.5;
        }

        .payment-badge {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            padding: var(--space-xs) var(--space-sm);
            background: var(--success-bg);
            color: var(--success);
            font-family: var(--font-body);
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-radius: var(--radius-full);
        }

        /* Payment Details (expandable) */
        .payment-details {
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px dashed var(--mist);
            display: none;
            animation: slideDown 0.3s ease-out;
        }

        .payment-method.selected .payment-details {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .cod-info {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--warning-bg);
            border-radius: var(--radius-lg);
            border-left: 4px solid var(--warning);
        }

        .cod-info svg {
            color: var(--warning);
            flex-shrink: 0;
        }

        .cod-info p {
            font-family: var(--font-body);
            font-size: 0.9rem;
            color: #92400e;
            margin: 0;
            line-height: 1.5;
        }

        .momo-qr-section {
            text-align: center;
        }

        .momo-qr-placeholder {
            width: 200px;
            height: 200px;
            margin: 0 auto var(--space-md);
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            border: 3px dashed #ec4899;
            border-radius: var(--radius-xl);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            color: #be185d;
        }

        .momo-qr-placeholder svg {
            opacity: 0.7;
        }

        .momo-qr-placeholder span {
            font-family: var(--font-body);
            font-size: 0.85rem;
            font-weight: 600;
        }

        .momo-phone {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: var(--space-md);
            background: var(--cloud);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-md);
        }

        .momo-phone-label {
            font-family: var(--font-body);
            font-size: 0.85rem;
            color: var(--slate);
        }

        .momo-phone-number {
            font-family: var(--font-mono);
            font-size: 1.1rem;
            font-weight: 600;
            color: #be185d;
            letter-spacing: 0.05em;
        }

        .momo-note {
            font-family: var(--font-body);
            font-size: 0.85rem;
            color: var(--slate);
            font-style: italic;
        }

        /* Order Summary Sidebar */
        .order-summary {
            background: var(--white);
            border-radius: var(--radius-2xl);
            padding: var(--space-2xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--mist);
            position: sticky;
            top: 100px;
        }

        .summary-items {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: var(--space-lg);
            padding-right: var(--space-sm);
        }

        .summary-item {
            display: flex;
            gap: var(--space-md);
            padding: var(--space-md) 0;
            border-bottom: 1px solid var(--mist);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-item-cover {
            width: 60px;
            height: 80px;
            background: var(--gradient-teal);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .summary-item-cover::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 8px;
            background: linear-gradient(90deg, var(--teal-dark) 0%, var(--teal) 50%, var(--teal-dark) 100%);
        }

        .summary-item-cover svg {
            color: rgba(255, 255, 255, 0.9);
        }

        .summary-item-info {
            flex: 1;
            min-width: 0;
        }

        .summary-item-name {
            font-family: var(--font-display);
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--ink);
            margin: 0 0 var(--space-xs) 0;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .summary-item-qty {
            font-family: var(--font-body);
            font-size: 0.8rem;
            color: var(--slate);
            margin: 0;
        }

        .summary-item-price {
            font-family: var(--font-mono);
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--teal);
            white-space: nowrap;
        }

        /* Summary Totals */
        .summary-divider {
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--mist), transparent);
            margin: var(--space-lg) 0;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) 0;
        }

        .summary-label {
            font-family: var(--font-body);
            font-size: 0.95rem;
            color: var(--slate);
        }

        .summary-value {
            font-family: var(--font-mono);
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--graphite);
        }

        .summary-row-total {
            margin-top: var(--space-md);
            padding-top: var(--space-md);
            border-top: 2px solid var(--teal-muted);
        }

        .summary-row-total .summary-label {
            font-family: var(--font-display);
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--ink);
        }

        .summary-row-total .summary-value {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--teal);
        }

        /* Action Buttons */
        .checkout-actions {
            margin-top: var(--space-xl);
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .btn-checkout {
            width: 100%;
            padding: var(--space-lg) var(--space-xl);
            font-family: var(--font-body);
            font-size: 1.1rem;
            font-weight: 700;
            border-radius: var(--radius-full);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .btn-checkout::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-checkout:hover::before {
            left: 100%;
        }

        .btn-checkout-primary {
            background: var(--gradient-teal);
            color: var(--white);
            box-shadow: 0 4px 20px rgba(13, 148, 136, 0.3);
        }

        .btn-checkout-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(13, 148, 136, 0.4);
        }

        .btn-checkout-primary:active {
            transform: translateY(0);
        }

        .btn-checkout-secondary {
            background: var(--cloud);
            color: var(--graphite);
            border: 2px solid var(--mist);
        }

        .btn-checkout-secondary:hover {
            background: var(--white);
            border-color: var(--teal);
            color: var(--teal);
        }

        /* Trust Badges */
        .trust-badges {
            display: flex;
            justify-content: center;
            gap: var(--space-lg);
            margin-top: var(--space-xl);
            padding-top: var(--space-lg);
            border-top: 1px solid var(--mist);
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-family: var(--font-body);
            font-size: 0.75rem;
            color: var(--slate);
        }

        .trust-badge svg {
            color: var(--success);
        }

        /* Responsive */
        @media (max-width: 992px) {
            .checkout-grid {
                grid-template-columns: 1fr;
            }

            .order-summary {
                position: static;
            }

            .checkout-steps::before {
                width: 200px;
            }
        }

        @media (max-width: 768px) {
            .checkout-title {
                font-size: 1.8rem;
            }

            .checkout-steps {
                gap: var(--space-md);
            }

            .checkout-steps::before {
                display: none;
            }

            .step-number {
                width: 40px;
                height: 40px;
                font-size: 0.95rem;
            }

            .step-label {
                font-size: 0.75rem;
            }

            .payment-section,
            .order-summary {
                padding: var(--space-lg);
            }

            .payment-method {
                padding: var(--space-md);
            }

            .payment-icon {
                width: 48px;
                height: 36px;
            }

            .payment-name {
                font-size: 1rem;
            }

            .trust-badges {
                flex-direction: column;
                align-items: center;
                gap: var(--space-sm);
            }
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">
<th:block th:replace="~{layout::header}"></th:block>

<main class="flex-grow-1">
    <div class="checkout-container animate-fade-in">
        <!-- Checkout Header -->
        <div class="checkout-header">
            <h1 class="checkout-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1z"/>
                    <path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1z"/>
                </svg>
                Thanh Toán
            </h1>
            <p class="checkout-subtitle">Hoàn tất đơn hàng của bạn một cách an toàn</p>
        </div>

        <!-- Progress Steps -->
        <div class="checkout-steps">
            <div class="step completed">
                <div class="step-number">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z"/>
                    </svg>
                </div>
                <span class="step-label">Giỏ hàng</span>
            </div>
            <div class="step active">
                <div class="step-number">2</div>
                <span class="step-label">Thanh toán</span>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <span class="step-label">Hoàn tất</span>
            </div>
        </div>

        <!-- Main Content -->
        <form th:action="@{/cart/place-order}" method="post">
            <div class="checkout-grid">
                <!-- Payment Methods -->
                <div class="payment-section">
                    <h2 class="section-title-checkout">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M1.5 2A1.5 1.5 0 0 0 0 3.5v2h6a.5.5 0 0 1 .5.5c0 .253.08.644.306.958.207.288.557.542 1.194.542s.987-.254 1.194-.542C9.42 6.644 9.5 6.253 9.5 6a.5.5 0 0 1 .5-.5h6v-2A1.5 1.5 0 0 0 14.5 2zM16 6.5h-5.551a2.7 2.7 0 0 1-.443 1.042C9.613 8.088 8.963 8.5 8 8.5s-1.613-.412-2.006-.958A2.7 2.7 0 0 1 5.551 6.5H0v6A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5z"/>
                        </svg>
                        Chọn phương thức thanh toán
                    </h2>

                    <div class="payment-methods">
                        <!-- COD Payment -->
                        <label class="payment-method selected" id="cod-method">
                            <div class="payment-badge">Phổ biến</div>
                            <div class="payment-method-header">
                                <div class="payment-radio">
                                    <input type="radio" name="paymentMethod" value="COD" checked>
                                    <span class="payment-radio-custom"></span>
                                </div>
                                <div class="payment-icon payment-icon-cod">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
                                        <path d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2z"/>
                                    </svg>
                                </div>
                                <div class="payment-info">
                                    <h3 class="payment-name">Thanh toán khi nhận hàng (COD)</h3>
                                    <p class="payment-desc">Thanh toán bằng tiền mặt khi nhận được sách tại nhà</p>
                                </div>
                            </div>
                            <div class="payment-details">
                                <div class="cod-info">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/>
                                    </svg>
                                    <p>Vui lòng chuẩn bị đủ tiền mặt khi nhận hàng. Nhân viên giao hàng sẽ thu tiền và giao sách tận tay bạn.</p>
                                </div>
                            </div>
                        </label>

                        <!-- MOMO Payment -->
                        <label class="payment-method" id="momo-method">
                            <div class="payment-method-header">
                                <div class="payment-radio">
                                    <input type="radio" name="paymentMethod" value="MOMO">
                                    <span class="payment-radio-custom"></span>
                                </div>
                                <div class="payment-icon payment-icon-momo">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" viewBox="0 0 16 16">
                                        <path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0M4.5 7.5a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1zm0 2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1z"/>
                                        <path d="M5.27 3.5a1.5 1.5 0 0 1 1.5-1.5h2.46a1.5 1.5 0 0 1 1.5 1.5v.5H5.27zm0 8.5h5.46v.5a1.5 1.5 0 0 1-1.5 1.5H6.77a1.5 1.5 0 0 1-1.5-1.5z"/>
                                    </svg>
                                </div>
                                <div class="payment-info">
                                    <h3 class="payment-name">Ví điện tử MoMo</h3>
                                    <p class="payment-desc">Thanh toán nhanh chóng qua ứng dụng MoMo</p>
                                </div>
                            </div>
                            <div class="payment-details">
                                <div class="momo-qr-section">
                                    <div class="momo-qr-placeholder">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 16 16">
                                            <path d="M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5M.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5m15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5M4 4h1v1H4zm2 0h1v1H6zm2 0h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1zM4 6h1v1H4zm4 0h1v1H8zm4 0h1v1h-1zM4 8h1v1H4zm2 0h1v1H6zm2 0h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1zM4 10h1v1H4zm4 0h1v1H8zm4 0h1v1h-1zM4 12h1v1H4zm2 0h1v1H6zm2 0h1v1H8zm2 0h1v1h-1zm2 0h1v1h-1z"/>
                                        </svg>
                                        <span>Mã QR sẽ hiển thị</span>
                                    </div>
                                    <div class="momo-phone">
                                        <span class="momo-phone-label">Số điện thoại MoMo:</span>
                                        <span class="momo-phone-number">0123 456 789</span>
                                    </div>
                                    <p class="momo-note">Quét mã QR hoặc chuyển khoản đến số điện thoại trên với nội dung: <strong>BookHaven [Mã đơn hàng]</strong></p>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <h2 class="section-title-checkout">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l.84 4.479 9.144-.459L13.89 4zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
                        </svg>
                        Đơn hàng của bạn
                    </h2>

                    <div class="summary-items">
                        <div class="summary-item" th:each="item : ${cart.cartItems}">
                            <div class="summary-item-cover">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492z"/>
                                </svg>
                            </div>
                            <div class="summary-item-info">
                                <h4 class="summary-item-name" th:text="${item.bookName}">Tên sách</h4>
                                <p class="summary-item-qty">Số lượng: <span th:text="${item.quantity}">1</span></p>
                            </div>
                            <span class="summary-item-price">
                                <span th:text="${#numbers.formatDecimal(item.price * item.quantity, 0, 'COMMA', 0, 'POINT')}">0</span>đ
                            </span>
                        </div>
                    </div>

                    <div class="summary-divider"></div>

                    <div class="summary-row">
                        <span class="summary-label">Tạm tính</span>
                        <span class="summary-value">
                            <span th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT')}">0</span>đ
                        </span>
                    </div>
                    <div class="summary-row">
                        <span class="summary-label">Phí vận chuyển</span>
                        <span class="summary-value" style="color: var(--success);">Miễn phí</span>
                    </div>
                    <div class="summary-row summary-row-total">
                        <span class="summary-label">Tổng cộng</span>
                        <span class="summary-value">
                            <span th:text="${#numbers.formatDecimal(totalPrice, 0, 'COMMA', 0, 'POINT')}">0</span>đ
                        </span>
                    </div>

                    <div class="checkout-actions">
                        <button type="submit" class="btn-checkout btn-checkout-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z"/>
                            </svg>
                            Xác nhận đặt hàng
                        </button>
                        <a href="/cart" class="btn-checkout btn-checkout-secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
                            </svg>
                            Quay lại giỏ hàng
                        </a>
                    </div>

                    <div class="trust-badges">
                        <div class="trust-badge">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"/>
                            </svg>
                            An toàn
                        </div>
                        <div class="trust-badge">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/>
                                <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"/>
                            </svg>
                            Giao hàng nhanh
                        </div>
                        <div class="trust-badge">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M12.354 4.354a.5.5 0 0 0-.708-.708L5 10.293 1.854 7.146a.5.5 0 1 0-.708.708l3.5 3.5a.5.5 0 0 0 .708 0z"/>
                            </svg>
                            Đảm bảo chất lượng
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</main>

<th:block th:replace="~{layout::footer}"></th:block>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const paymentMethods = document.querySelectorAll('.payment-method');
    const radioInputs = document.querySelectorAll('input[name="paymentMethod"]');

    paymentMethods.forEach(method => {
        method.addEventListener('click', function() {
            // Remove selected from all
            paymentMethods.forEach(m => m.classList.remove('selected'));
            // Add selected to clicked
            this.classList.add('selected');
            // Check the radio
            const radio = this.querySelector('input[type="radio"]');
            if (radio) radio.checked = true;
        });
    });

    // Handle radio change directly
    radioInputs.forEach(radio => {
        radio.addEventListener('change', function() {
            paymentMethods.forEach(m => m.classList.remove('selected'));
            this.closest('.payment-method').classList.add('selected');
        });
    });
});
</script>
</body>
</html>
